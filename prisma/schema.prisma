generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Country {
  id String @id @default(cuid())

  name      String
  imageUrl  String @db.Text
  latitude  Float
  longitude Float
  zoom      Float

  islands Island[]
  states  State[]
  cities  City[]
  places  Place[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@map("countries")
}

model Island {
  id String @id @default(cuid())

  name      String
  imageUrl  String @db.Text
  latitude  Float
  longitude Float
  zoom      Float
  slug      String @unique

  country   Country @relation(fields: [countryId], references: [id])
  countryId String
  states    State[]
  cities    City[]
  places    Place[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@map("islands")
}

model State {
  id String @id @default(cuid())

  name      String
  imageUrl  String @db.Text
  latitude  Float
  longitude Float
  zoom      Float

  island    Island? @relation(fields: [islandId], references: [id])
  islandId  String?
  countryId String
  country   Country @relation(fields: [countryId], references: [id])
  cities    City[]
  places    Place[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@map("states")
}

model City {
  id String @id @default(cuid())

  name      String
  imageUrl  String @db.Text
  latitude  Float
  longitude Float
  zoom      Float

  country   Country @relation(fields: [countryId], references: [id])
  countryId String
  state     State   @relation(fields: [stateId], references: [id])
  stateId   String
  Island    Island? @relation(fields: [islandId], references: [id])
  islandId  String?
  places    Place[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@map("cities")
}

model Category {
  id String @id @default(cuid())

  slug       String  @unique
  name       String
  isFeatured Boolean @default(false)
  position   Int?

  places Place[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@map("categories")
}

model Place {
  id String @id @default(cuid())

  title       String
  slug        String @unique
  description String @db.Text
  imageUrl    String @db.Text
  latitude    Float
  longitude   Float
  zoom        Float
  address     String @db.Text

  country    Country      @relation(fields: [countryId], references: [id])
  countryId  String
  state      State        @relation(fields: [stateId], references: [id])
  stateId    String
  city       City         @relation(fields: [cityId], references: [id])
  cityId     String
  category   Category     @relation(fields: [categoryId], references: [id])
  categoryId String
  island     Island?      @relation(fields: [islandId], references: [id])
  islandId   String?
  images     PlaceImage[]

  // countryId String
  // country   Country @relation(fields: [countryId], references: [id])

  // stateId String
  // state   State  @relation(fields: [stateId], references: [id])

  // cityId String
  // city   City   @relation(fields: [cityId], references: [id])

  // categories Category[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@index([countryId, stateId, cityId])
  @@map("places")
}

model PlaceImage {
  id String @id @default(cuid())

  url         String @db.Text
  title       String
  description String @db.Text

  place   Place  @relation(fields: [placeId], references: [id])
  placeId String

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@map("placeImages")
}
